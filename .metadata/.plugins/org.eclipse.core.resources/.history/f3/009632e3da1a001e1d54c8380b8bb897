<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="test.com.idle">

	<select id="R_SELECT_ALL" resultType="test.com.idle.vo.RoomVO">
		select r.*, b.board_title,
		b.price, m.member_savename
		from room r
		join board b on b.board_num = r.board_num
		join member m on m.id = case when r.buyer = #{buyer} then r.seller else
		r.buyer end
		where r.buyer = #{buyer} or r.seller = #{buyer}
		order by room_num
	</select>

	<select id="R_CHECK" resultType="test.com.idle.vo.RoomVO">
		select * from room where
		board_num=#{board_num} and seller=#{seller} and buyer=#{buyer}
	</select>

	<insert id="R_INSERT">
		insert into room(room_num,board_num,buyer,seller)
		values(seq_room.nextval,#{board_num},#{buyer},#{seller})
	</insert>

</mapper>